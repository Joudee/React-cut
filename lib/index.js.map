{"version":3,"sources":["../src/index.jsx"],"names":["require","Cutting","createClass","getInitialState","touch","x","y","positionX","positionY","defaultPosition","hasEnd","frameWidth","props","config","frameHeight","defaultBtPosition","defaultWidth","defaultHeight","defaultPositionX","defaultPositionY","realImage","handleTouchStart","e","touches","setState","pageX","pageY","state","handleTouchMove","preventDefault","X","Y","startX","startY","moveX","moveY","refs","frame","clientWidth","cutting","clientHeight","handleTouchEnd","handleBtTouchStart","onTouchBtMove","num","frameScale","stopPropagation","minW","minH","cacheExternalImage","url","img","Image","crossOrigin","src","Images","that","canvas","ctx","getContext","width","height","style","drawImage","getCutImage","toDataURL","convertBase64UrlToBlob","copyImageToFixSize","onload","bgImg","dataURI","byteString","split","indexOf","atob","unescape","mimeString","ia","Uint8Array","length","i","charCodeAt","Blob","type","componentDidMount","render","left","top","display","bind","module","exports"],"mappings":"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","file":"index.js","sourcesContent":["import React from 'react'\nrequire('./index.css')\n\nvar Cutting = React.createClass({\n    getInitialState:function(){\n        return{\n            touch:{\n                x:0,\n                y:0\n            },\n            positionX:0,\n            positionY:0,\n            defaultPosition:{\n                x:0,\n                y:0\n            },\n            hasEnd:true,\n            frameWidth:this.props.config.frameWidth?this.props.config.frameWidth:'100%',\n            frameHeight:this.props.config.frameHeight?this.props.config.frameHeight:200,\n            defaultBtPosition:{\n                x:0,\n                y:0\n            },\n            defaultWidth:'100%',\n            defaultHeight:200,\n            defaultPositionX:0,\n            defaultPositionY:0,\n            realImage:''\n        }\n    },\n    handleTouchStart:function(e){\n        let touch = e.touches[0];\n        this.setState({\n            touch:{\n                x:touch.pageX,\n                y:touch.pageY\n            },\n            defaultPosition:{\n                x:this.state.positionX,\n                y:this.state.positionY\n            }\n        })\n    },\n    handleTouchMove:function(e){\n        e.preventDefault();\n        let touch = e.touches[0],\n            X = touch.pageX,\n            Y = touch.pageY,\n            startX = this.state.touch.x,\n            startY = this.state.touch.y;\n        let moveX = X - startX,\n            moveY = Y - startY;\n        if((this.state.defaultPosition.x + moveX)>-1&&(this.state.defaultPosition.x + moveX + this.refs.frame.clientWidth)<this.refs.cutting.clientWidth-1){\n            this.setState({\n                positionX:this.state.defaultPosition.x + moveX\n            })\n        }\n\n        if((this.state.defaultPosition.x + moveX)<0){\n            this.setState({\n                positionX:0\n            })\n        }\n\n        if((this.state.defaultPosition.x + moveX + this.refs.frame.clientWidth)>this.refs.cutting.clientWidth){\n            this.setState({\n                positionX:this.refs.cutting.clientWidth - this.refs.frame.clientWidth\n            })\n        }\n\n        if((this.state.defaultPosition.y + moveY)>-1&&(this.state.defaultPosition.y + moveY + this.refs.frame.clientHeight)<this.refs.cutting.clientHeight-1){\n            this.setState({\n                positionY:this.state.defaultPosition.y + moveY\n            })\n        }\n\n        if((this.state.defaultPosition.y + moveY)<0){\n            this.setState({\n                positionY:0\n            })\n        }\n\n        if((this.state.defaultPosition.y + moveY + this.refs.frame.clientHeight)>this.refs.cutting.clientHeight-1){\n            this.setState({\n                positionY:this.refs.cutting.clientHeight - this.refs.frame.clientHeight\n            })\n        }\n    },\n    handleTouchEnd:function(){\n        this.setState({\n            hasEnd:true\n        })\n    },\n    handleBtTouchStart:function(e){\n        let touch = e.touches[0];\n        this.setState({\n            defaultBtPosition:{\n                x:touch.pageX,\n                y:touch.pageY\n            },\n            defaultWidth:this.refs.frame.clientWidth,\n            defaultHeight:this.refs.frame.clientHeight,\n            defaultPositionX:this.state.positionX,\n            defaultPositionY:this.state.positionY\n        })\n    },\n    onTouchBtMove:function(num,e){\n        if(this.props.config.frameScale){\n            e.stopPropagation();\n            e.preventDefault();\n            let touch = e.touches[0],\n                moveX = touch.pageX - this.state.defaultBtPosition.x,\n                moveY = touch.pageY - this.state.defaultBtPosition.y;\n            let minW = this.props.config.minW?this.props.config.minW:200,\n                minH = this.props.config.minH?this.props.config.minH:200;\n            if(num == 'bt0'||num == 'bt2'){\n                if((this.state.defaultWidth - moveX>minW-1)){\n                    this.setState({\n                        frameWidth:this.state.defaultWidth - moveX,\n                        positionX:this.state.defaultPosition.x + moveX\n                    })\n                }\n                if(this.state.defaultWidth - moveX<minW){\n                    this.setState({\n                        frameWidth:minW,\n                        positionX:this.state.defaultPosition.x + this.state.defaultWidth - minW\n                    })\n                }\n                if(this.state.defaultPosition.x + moveX<0){\n                    this.setState({\n                        frameWidth:this.state.defaultWidth + this.state.defaultPositionX,\n                        positionX:0\n                    })\n                }\n            }\n            if(num == 'bt0'||num == 'bt1'){\n                if((this.state.defaultHeight - moveY>minH-1)){\n                    this.setState({\n                        frameHeight:this.state.defaultHeight - moveY,\n                        positionY:this.state.defaultPosition.y + moveY\n                    })\n                }\n                if(this.state.defaultHeight - moveY<minH){\n                    this.setState({\n                        frameHeight:minH,\n                        positionY:this.state.defaultPosition.y + this.state.defaultHeight - minH\n                    })\n                }\n                if(this.state.defaultPosition.y + moveY<0){\n                    this.setState({\n                        frameHeight:this.state.defaultHeight + this.state.defaultPositionY,\n                        positionY:0\n                    })\n                }\n            }\n            if(num == 'bt1'||num == 'bt3'){\n                if((this.state.defaultWidth + moveX>minW-1)){\n                    this.setState({\n                        frameWidth:this.state.defaultWidth + moveX\n                    })\n                }\n                if((this.state.defaultWidth + moveX + this.state.defaultPosition.x)> this.refs.cutting.clientWidth){\n                    this.setState({\n                        frameWidth:this.refs.cutting.clientWidth - this.state.defaultPosition.x\n                    })\n                }\n                if((this.state.defaultWidth + moveX<minW)){\n                    this.setState({\n                        frameWidth:minW\n                    })\n                }\n            }\n            if(num == 'bt2'||num == 'bt3'){\n                if((this.state.defaultHeight + moveY>minH-1)){\n                    this.setState({\n                        frameHeight:this.state.defaultHeight + moveY\n                    })\n                }\n                if((this.state.defaultHeight + moveY<minH)){\n                    this.setState({\n                        frameHeight:minH\n                    })\n                }\n                if((this.state.defaultHeight + moveY + this.state.defaultPosition.y)>this.refs.cutting.clientHeight){\n                    this.setState({\n                        frameHeight:this.refs.cutting.clientHeight - this.state.defaultPosition.y\n                    })\n                }\n            }\n        }\n    },\n    cacheExternalImage:function(url){\n        let img = new Image();\n        img.crossOrigin = \"Anonymous\";\n        img.src = url;\n        return img\n    },\n    cutting:function(){\n        let Images = new Image(),\n            img = this.cacheExternalImage(this.state.realImage),\n            that = this,\n            canvas = this.refs.canvas,\n            ctx=canvas.getContext('2d');\n        canvas.width = this.state.frameWidth;\n        canvas.height = this.state.frameHeight;\n        canvas.style.width = this.state.frameWidth + 'px';\n        canvas.style.height = this.state.frameHeight + 'px';\n        ctx.drawImage(img,this.state.positionX,this.state.positionY,this.state.frameWidth,this.state.frameHeight,0,0,this.state.frameWidth,this.state.frameHeight);\n        this.props.getCutImage(canvas.toDataURL(\"image/jpeg\", 1.0),this.convertBase64UrlToBlob(canvas.toDataURL(\"image/jpeg\", 1.0)));\n    },\n    copyImageToFixSize:function(){\n        let Images = new Image(),\n            img = this.cacheExternalImage(this.props.config.url),\n            that = this,\n            canvas = this.refs.canvas,\n            ctx=canvas.getContext('2d');\n            Images.src = this.props.config.url;\n        Images.onload = function(){\n            canvas.style.height = that.refs.bgImg.clientHeight+'px';\n            canvas.style.width = that.refs.bgImg.clientWidth+'px';\n            canvas.height = that.refs.bgImg.clientHeight;\n            canvas.width = that.refs.bgImg.clientWidth;\n            ctx.drawImage(img,0,0,that.refs.bgImg.clientWidth,that.refs.bgImg.clientHeight);\n            that.setState({\n                realImage:canvas.toDataURL(\"image/jpeg\", 1.0)\n            })\n        }\n    },\n    convertBase64UrlToBlob:function(dataURI){\n        let byteString;\n        if (dataURI.split(',')[0].indexOf('base64') >= 0){\n            byteString = atob(dataURI.split(',')[1]);\n        }else{\n            byteString = unescape(dataURI.split(',')[1]);\n        }\n        let mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\n        let ia = new Uint8Array(byteString.length);\n        for (let i = 0; i < byteString.length; i++) {\n            ia[i] = byteString.charCodeAt(i);\n        }\n        return new Blob([ia], {type:mimeString});\n    },\n    componentDidMount:function(){\n        this.copyImageToFixSize();\n    },\n    render: function () {\n        return (\n            <div className='cutting' ref='cutting'>\n                <img src={this.props.config.url} className='bg-img' ref='bgImg'/>\n                <div className='cover'>\n                    <div className='frame' ref='frame' style={{left:this.state.positionX,top:this.state.positionY,width:this.state.frameWidth,height:this.state.frameHeight}} onTouchStart={this.handleTouchStart} onTouchMove={this.handleTouchMove} onTouchEnd={this.handleTouchEnd}>\n                        <span style={this.props.config.frameScale?{display:'block'}:{display:'none'}} onTouchStart={this.handleBtTouchStart} onTouchMove={this.onTouchBtMove.bind(null,'bt0')}></span>\n                        <span style={this.props.config.frameScale?{display:'block'}:{display:'none'}} onTouchStart={this.handleBtTouchStart} onTouchMove={this.onTouchBtMove.bind(null,'bt1')}></span>\n                        <span style={this.props.config.frameScale?{display:'block'}:{display:'none'}} onTouchStart={this.handleBtTouchStart} onTouchMove={this.onTouchBtMove.bind(null,'bt2')}></span>\n                        <span style={this.props.config.frameScale?{display:'block'}:{display:'none'}} onTouchStart={this.handleBtTouchStart} onTouchMove={this.onTouchBtMove.bind(null,'bt3')}></span>\n                        <img src={this.props.config.url} style={{width:this.props.config.width,left:-this.state.positionX,top:-this.state.positionY}}/>\n                        <div></div>\n                    </div>\n                </div>\n                <canvas ref='canvas' style={{display:'none'}}></canvas>\n                <div className='cutBt' onTouchStart={this.cutting}>Cutting</div>\n            </div>\n        )\n    }\n})\n\nmodule.exports = Cutting"]}